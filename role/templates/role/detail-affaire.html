{% extends 'start/base.html' %}


{% block title %}Formalite{% endblock title %}

{% block content %}
{% load static %}


    <div class="page-wrapper">
        <div class="mb-4 d-flex flex-wrap align-items-center gap-2 px-3 py-2" 
        style="background: var(--Bleu, #143642); border-radius: 4px;">

    <span class="text-white fw-bold" style="font-family: Jost; font-size: 1rem;">
        Procédures
    </span>

    <svg xmlns="http://www.w3.org/2000/svg" width="0.8em" height="1.2em" viewBox="0 0 10 17" fill="white">
        <path d="M2.22229 16.5L7.77771 10.7857L10 8.5L7.77771 6.21433L2.22229 0.5L0 2.78567L5.55543 8.5L0 14.2143L2.22229 16.5Z"/>
    </svg>

    <a href="{% url 'role.index' %}" class="text-decoration-none">
        <span class="text-white fw-bold" style="font-family: Jost; font-size: 1rem;">
            Rôles d'audiences
        </span>
    </a>

    <svg xmlns="http://www.w3.org/2000/svg" width="0.8em" height="1.2em" viewBox="0 0 10 17" fill="white">
        <path d="M2.22229 16.5L7.77771 10.7857L10 8.5L7.77771 6.21433L2.22229 0.5L0 2.78567L5.55543 8.5L0 14.2143L2.22229 16.5Z"/>
    </svg>

    <a href="{% url 'role.detail' affaire.role.idRole %}" class="text-decoration-none">
        <span class="text-white fw-bold" style="font-family: Jost; font-size: 1rem;">
            Rôle d'audience de {{ affaire.role.typeAudience }} du {{ affaire.role.dateEnreg }}
        </span>
    </a>

    <svg xmlns="http://www.w3.org/2000/svg" width="0.8em" height="1.2em" viewBox="0 0 10 17" fill="white">
        <path d="M2.22229 16.5L7.77771 10.7857L10 8.5L7.77771 6.21433L2.22229 0.5L0 2.78567L5.55543 8.5L0 14.2143L2.22229 16.5Z"/>
    </svg>

    <span class="fw-bold" style="color: var(--Jaune, #DFB23D); font-family: Jost; font-size: 1rem;">
        Décisions affaire N° {{ affaire.numAffaire }}
    </span>
    </div>

    <div class="page-body">
        <div class="container-fluid">
            <div class="row g-3">
                <!-- <div class="col-2">
                    <div class="card" style="padding: 8px;">
                        <img src="" width="110" height="130" style="margin-left:17% ;" alt="Tabler" class="mb-3">
                        <a href="" download="" class="btn btn-success btn-pill w-100"
                            title="Telecharger le document original">
                          
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24"
                                viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none"
                                stroke-linecap="round" stroke-linejoin="round">
                                <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                                <path d="M4 17v2a2 2 0 0 0 2 2h12a2 2 0 0 0 2 -2v-2" />
                                <polyline points="7 11 12 16 17 11" />
                                <line x1="12" y1="4" x2="12" y2="16" />
                            </svg> Telecharger
                        </a>
                    </div>
                </div> -->
                <div class="col-12 animate-bottom">
                    <div class="card card-body">
                        <div class="row text-center text-md-start">
                            <!-- Bloc gauche -->
                            <div class="col-12 col-md-4 mb-3">
                                <p class="fs-4 fw-bold">{{ affaire.role.juridiction }}</p>
                                <p class="fs-5 text-muted">NUA : {{ affaire.numAffaire }}</p>
                                <p class="fs-5">N° RG : {{ affaire.numRg }}</p>
                                <p class="fs-5">{{ affaire.role.get_section_display }}</p>
                                <p class="fs-5">{{ affaire.role.get_typeAudience_display }}</p>
                
                                {% if is_suivi %}
                                    <span class="badge bg-success text-light fs-5 d-inline-flex align-items-center">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24" class="me-1">
                                            <path fill="white" d="M23 10a2 2 0 0 0-2-2h-6.32l.96-4.57c.02-.1.03-.21.03-.32c0-.41-.17-.79-.44-1.06L14.17 1L7.59 7.58C7.22 7.95 7 8.45 7 9v10a2 2 0 0 0 2 2h9c.83 0 1.54-.5 1.84-1.22l3.02-7.05c.09-.23.14-.47.14-.73zM1 21h4V9H1z"/>
                                        </svg>
                                        Vous suivez cette affaire
                                    </span>
                                {% endif %}
                            </div>
                
                            <!-- Bloc centre -->
                            <div class="col-12 col-md-4 mb-3 text-center">
                                <p class="fs-4 fw-bold text-primary text-decoration-underline">
                                    Ministère de la Justice et du Droit de l'Homme
                                </p>
                            </div>
                
                            <!-- Bloc droite -->
                            <div class="col-12 col-md-4 mb-3 text-center">
                                <p class="fs-5 fw-bold">REPUBLIQUE DE GUINÉE</p>
                                <address class="mb-0">
                                    Travail - Justice - Solidarité
                                </address>
                            </div>
                        </div>
                
                        <hr>
                        <p class="fs-3 fw-bold text-center text-decoration-underline mb-4">
                            DÉCISIONS RENDUES
                        </p>
                
                        <div class="row g-3 my-4">
                            <!-- Bloc Président & Greffier -->
                            <div class="col-12 col-md-6">
                                {% if affaire.role.president %}
                                    <p class="fs-4 text-decoration-underline"><b>PRESIDENT(E) :</b> {{ affaire.role.president }}</p>
                                {% endif %}
                
                                {% if affaire.role.greffier %}
                                    <p class="fs-4 text-decoration-underline"><b>GREFFIER(E) :</b> {{ affaire.role.greffier }}</p>
                                {% endif %}
                            </div>
                
                            <!-- Bloc Parties & Objet -->
                            <div class="col-12 col-md-6">
                                {% if affaire.demandeurs %}
                                    <p class="fs-4 text-decoration-underline">
                                        <b>PARTIES : </b>{{ affaire.demandeurs }} <mark>C/</mark> {{ affaire.defendeurs }}
                                    </p>
                                {% endif %}
                
                                {% if affaire.objet %}
                                    <p class="fs-4 text-decoration-underline"><b>OBJET :</b> {{ affaire.objet }}</p>
                                {% endif %}
                            </div>
                        </div>
                
                        <!-- Tableau responsive -->
                        <div class="table-responsive mb-5">
                            <table class="table table-bordered table-striped align-middle">
                                <thead class="table-light">
                                    <tr class="text-center">
                                        <th style="font-size:small;">N°</th>
                                        <th style="font-size:small;">Audience du</th>
                                        <th style="font-size:small;">Type de décision</th>
                                        <th style="font-size:small;">Décision</th>
                                        <th style="font-size:small;">Prochaine Audience</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    {% for decision in decisions %}
                                        <tr>
                                            <td class="text-center">{{ forloop.counter }}</td>
                                            <td class="text-center">{{ decision.dateDecision|default:"Non défini" }}</td>
                                            <td class="text-center">{{ decision.typeDecision }}</td>
                                            <td style="white-space: pre-wrap;">{{ decision.decision }}</td>
                                            <td class="text-center">
                                                <span class="badge bg-secondary">
                                                    {{ decision.prochaineAudience|default:"Non défini" }}
                                                </span>
                                            </td>
                                        </tr>
                                    {% empty %}
                                        <tr>
                                            <td colspan="7" class="text-center">
                                                <h5 class="text-muted">Aucune décision disponible</h5>
                                            </td>
                                        </tr>
                                    {% endfor %}
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
                
            </div>
        </div>
    </div>

</div>



<script>
    document.addEventListener('DOMContentLoaded', function() {
        const selectElement = document.getElementById('typeDecision');
        const divSection = document.getElementById('divSection');
        const selectSection = document.getElementById('selectSection');
    
        if (selectElement) {
            selectElement.addEventListener('change', function() {
                const selectedValue = this.value;
                console.log("Valeur sélectionnée :", selectedValue);
    
                // Exemple : afficher ou masquer un champ selon la valeur choisie
                if (selectedValue === 'Affectation') {
                    divSection.removeAttribute('hidden');
                    selectSection.setAttribute('required', true);
                } else {
                    divSection.setAttribute('hidden', true);
                    selectSection.removeAttribute('required');

                }
            });
        }
    });
</script>
    

<script>
    function isProchaineAudience() {
        var checkbox = document.getElementById("nonApplicable");
        if (checkbox.checked) {
            document.getElementById("prochaineAudience").disabled = true;
            document.getElementById("prochaineAudience").required = false;
        }else{
            document.getElementById("prochaineAudience").disabled = false;
            document.getElementById("prochaineAudience").required = true;
        }
        
    }

    function recuperationIDAffaire(id) {

        $("#idDecision").val(id);
        
    }

function openEditModal(decision) {
  document.getElementById('editDecisionId').value = decision.id;
  document.getElementById('editTypeDecision').value = decision.typeDecision;
  document.getElementById('editDateDecision').value = decision.dateDecision || '';
  document.getElementById('editPresident').value = decision.president;
  document.getElementById('editGreffier').value = decision.greffier;
  document.getElementById('editDecisionText').value = decision.decision;
  document.getElementById('editProchaineAudience').value = decision.prochaineAudience || '';

  // Affiche le modal
  var modal = new bootstrap.Modal(document.getElementById('modal-edit-decision'));
  modal.show();
}

</script>

<script>
    document.addEventListener("DOMContentLoaded", function () {

            document.getElementById("link_procedure").classList.add("active");
  
    });
</script>


{% endblock %}