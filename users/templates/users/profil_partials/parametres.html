{% load static %}

<div class="content-area">
    <h5 class="section-title mb-4">Paramètres du compte</h5>
    <div class="container-xl">
      <form method="POST" action="{% url 'profile' %}" enctype="multipart/form-data" >
        {% csrf_token %}
  
        <!-- SECTION 1 : Photo de profil -->
        <div class="card mb-4">
          <div class="card-header"><b>Photo de profil</b></div>
          <div class="card-body text-left">
            {% if request.user.profile_image %}
              <img src="{{ request.user.profile_image.url }}" alt="Photo profil" class="rounded-circle mb-3" width="100" height="100">
            {% elif request.user.socialaccount_set.exists %}
              <img src="{{ request.user.socialaccount_set.first.get_avatar_url }}" alt="Photo Google" class="rounded-circle mb-3" width="100" height="100">
            {% else %}
              <img src="https://cdn.pixabay.com/photo/2015/10/05/22/37/blank-profile-picture-973460_1280.png" alt="Photo par défaut" class="rounded-circle mb-3" width="100" height="100">
            {% endif %}
            <input type="file" name="profile_image" class="form-control" style="width: 50%;">
          </div>
        </div>
  
        <!-- SECTION 2 : Informations personnelles -->
        <div class="card mb-4">
          <div class="card-header"><b>Informations personnelles</b></div>
          <div class="card-body">
            <div class="row g-3 mb-2">
              <div class="col-md-6">
                <label class="form-label">Nom d'utilisateur</label>
                <input type="text" name="username" value="{{ request.user.username }}" class="form-control">
              </div>
            </div>
            <div class="row g-3">
              <div class="col-md-6">
                <label class="form-label">Prénom</label>
                <input type="text" name="first_name" value="{{ request.user.first_name }}" class="form-control" required>
              </div>
              <div class="col-md-6">
                <label class="form-label">Nom</label>
                <input type="text" name="last_name" value="{{ request.user.last_name }}" class="form-control" required>
              </div>
              <div class="col-md-6">
                <label class="form-label">Email</label>
                <input type="email" name="email" value="{{ request.user.email }}" class="form-control" required readonly>
              </div>
              <div class="col-md-6">
                <label class="form-label">Profession</label>
                <select name="profession" class="form-control" required>
                    <option value="" {% if not request.user.profession %}selected{% endif %}>
                        -- Sélectionnez une profession --
                    </option>
                    {% for value, label in professions %}
                        <option value="{{ value }}"
                            {% if request.user.profession == value %}selected{% endif %}>
                            {{ label }}
                        </option>
                    {% endfor %}
                </select>
            </div>
            
              <div class="col-md-6">
                  <label class="form-label">Téléphone 1</label>
                  <input type="tel" id="tel1" name="tel1" value="{{ request.user.tel1|default:'' }}" class="form-control" required>
              </div>
              <div class="col-md-6">
                  <label class="form-label">Téléphone 2</label>
                  <input type="tel" id="tel2" name="tel2" value="{{ request.user.tel2|default:'' }}" class="form-control" required>
              </div>
          
              <div class="col-md-6">
                <label class="form-label">Adresse</label>
                <input type="text" name="adresse" value="{{ request.user.adresse|default:'' }}" class="form-control" required>
              </div>
              <div class="col-md-6">
                <label class="form-label">Nationalité</label>
                <input type="text" name="nationnalite" value="{{ request.user.nationnalite }}" class="form-control" required>
              </div>
            </div>
          </div>
        </div>
  
        <!-- SECTION 3 : Changement de mot de passe (local uniquement) -->
        {% if not request.user.socialaccount_set.exists %}
        <div class="card mb-4">
          <div class="card-header"><b>Changer le mot de passe</b></div>
          <div class="card-body">
            <div class="row g-3">
              <div class="col-md-6">
                <label class="form-label">Nouveau mot de passe</label>
                <input type="password" name="password" class="form-control" placeholder="Laisser vide pour conserver le mot de passe actuel">
              </div>
              <div class="col-md-6">
                <label class="form-label">Confirmer mot de passe</label>
                <input type="password" name="confirm_password" class="form-control" placeholder="Confirmer le nouveau mot de passe">
              </div>
            </div>
          </div>
        </div>
        {% endif %}
  
        <!-- SECTION 4 : Notifications -->
        <!-- <div class="card mb-4">
          <div class="card-header"><b>Notifications</b></div>
          <div class="card-body">
            <div class="form-check mb-2">
              <input class="form-check-input" type="checkbox" name="notif_email" {% if request.user.notif_email %}checked{% endif %}>
              <label class="form-check-label">Notifications par email</label>
            </div>
            <div class="form-check">
              <input class="form-check-input" type="checkbox" name="notif_sms" {% if request.user.notif_sms %}checked{% endif %}>
              <label class="form-check-label">Notifications par SMS</label>
            </div>
          </div>
        </div> -->
  
        <!-- SECTION 5 : Comptes connectés (Google / OAuth) -->
        <!-- {% if request.user.socialaccount_set.exists %}
        <div class="card mb-4">
          <div class="card-header"><b>Comptes connectés</b></div>
          <div class="card-body d-flex justify-content-between align-items-center">
            <span>Connecté via {{ request.user.socialaccount_set.first.provider|title }}</span>
            <a href="" class="btn btn-outline-danger btn-sm">Dissocier Google</a>
          </div>
        </div>
        {% endif %} -->
  
        <!-- BOUTONS DE CONFIRMATION -->
        <div class="d-flex justify-content-between">
          <button class="btn btn-primary" name="update_profile">Mettre à jour</button>
          <!-- <a href=" class="btn btn-danger" onclick="return confirm('Êtes-vous sûr de vouloir supprimer votre compte ?')">Supprimer le compte</a> -->
        </div>
  
      </form>
    </div>
</div>


  